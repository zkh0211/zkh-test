'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _selectionIsBackward = require('selection-is-backward');

var _selectionIsBackward2 = _interopRequireDefault(_selectionIsBackward);

var _slate = require('slate');

var _findPoint = require('./find-point');

var _findPoint2 = _interopRequireDefault(_findPoint);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Find a Slate range from a DOM `nativeSelection`.
 *
 * @param {Selection} nativeSelection
 * @param {State} state
 * @return {Range}
 */

function findSelection(nativeSelection, state) {
  var anchorNode = nativeSelection.anchorNode,
      anchorOffset = nativeSelection.anchorOffset,
      focusNode = nativeSelection.focusNode,
      focusOffset = nativeSelection.focusOffset,
      isCollapsed = nativeSelection.isCollapsed;

  var anchor = (0, _findPoint2.default)(anchorNode, anchorOffset, state);
  var focus = isCollapsed ? anchor : (0, _findPoint2.default)(focusNode, focusOffset, state);
  if (!anchor || !focus) return null;

  var range = _slate.Range.create({
    anchorKey: anchor.key,
    anchorOffset: anchor.offset,
    focusKey: focus.key,
    focusOffset: focus.offset,
    isBackward: (0, _selectionIsBackward2.default)(nativeSelection),
    isFocused: true
  });

  return range;
}

/**
 * Export.
 *
 * @type {Function}
 */

exports.default = findSelection;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9maW5kLXNlbGVjdGlvbi5qcyJdLCJuYW1lcyI6WyJmaW5kU2VsZWN0aW9uIiwibmF0aXZlU2VsZWN0aW9uIiwic3RhdGUiLCJhbmNob3JOb2RlIiwiYW5jaG9yT2Zmc2V0IiwiZm9jdXNOb2RlIiwiZm9jdXNPZmZzZXQiLCJpc0NvbGxhcHNlZCIsImFuY2hvciIsImZvY3VzIiwicmFuZ2UiLCJjcmVhdGUiLCJhbmNob3JLZXkiLCJrZXkiLCJvZmZzZXQiLCJmb2N1c0tleSIsImlzQmFja3dhcmQiLCJpc0ZvY3VzZWQiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBOzs7O0FBQ0E7O0FBRUE7Ozs7OztBQUVBOzs7Ozs7OztBQVFBLFNBQVNBLGFBQVQsQ0FBdUJDLGVBQXZCLEVBQXdDQyxLQUF4QyxFQUErQztBQUFBLE1BQ3JDQyxVQURxQyxHQUM2QkYsZUFEN0IsQ0FDckNFLFVBRHFDO0FBQUEsTUFDekJDLFlBRHlCLEdBQzZCSCxlQUQ3QixDQUN6QkcsWUFEeUI7QUFBQSxNQUNYQyxTQURXLEdBQzZCSixlQUQ3QixDQUNYSSxTQURXO0FBQUEsTUFDQUMsV0FEQSxHQUM2QkwsZUFEN0IsQ0FDQUssV0FEQTtBQUFBLE1BQ2FDLFdBRGIsR0FDNkJOLGVBRDdCLENBQ2FNLFdBRGI7O0FBRTdDLE1BQU1DLFNBQVMseUJBQVVMLFVBQVYsRUFBc0JDLFlBQXRCLEVBQW9DRixLQUFwQyxDQUFmO0FBQ0EsTUFBTU8sUUFBUUYsY0FBY0MsTUFBZCxHQUF1Qix5QkFBVUgsU0FBVixFQUFxQkMsV0FBckIsRUFBa0NKLEtBQWxDLENBQXJDO0FBQ0EsTUFBSSxDQUFDTSxNQUFELElBQVcsQ0FBQ0MsS0FBaEIsRUFBdUIsT0FBTyxJQUFQOztBQUV2QixNQUFNQyxRQUFRLGFBQU1DLE1BQU4sQ0FBYTtBQUN6QkMsZUFBV0osT0FBT0ssR0FETztBQUV6QlQsa0JBQWNJLE9BQU9NLE1BRkk7QUFHekJDLGNBQVVOLE1BQU1JLEdBSFM7QUFJekJQLGlCQUFhRyxNQUFNSyxNQUpNO0FBS3pCRSxnQkFBWSxtQ0FBV2YsZUFBWCxDQUxhO0FBTXpCZ0IsZUFBVztBQU5jLEdBQWIsQ0FBZDs7QUFTQSxTQUFPUCxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztrQkFNZVYsYSIsImZpbGUiOiJmaW5kLXNlbGVjdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IGlzQmFja3dhcmQgZnJvbSAnc2VsZWN0aW9uLWlzLWJhY2t3YXJkJ1xuaW1wb3J0IHsgUmFuZ2UgfSBmcm9tICdzbGF0ZSdcblxuaW1wb3J0IGZpbmRQb2ludCBmcm9tICcuL2ZpbmQtcG9pbnQnXG5cbi8qKlxuICogRmluZCBhIFNsYXRlIHJhbmdlIGZyb20gYSBET00gYG5hdGl2ZVNlbGVjdGlvbmAuXG4gKlxuICogQHBhcmFtIHtTZWxlY3Rpb259IG5hdGl2ZVNlbGVjdGlvblxuICogQHBhcmFtIHtTdGF0ZX0gc3RhdGVcbiAqIEByZXR1cm4ge1JhbmdlfVxuICovXG5cbmZ1bmN0aW9uIGZpbmRTZWxlY3Rpb24obmF0aXZlU2VsZWN0aW9uLCBzdGF0ZSkge1xuICBjb25zdCB7IGFuY2hvck5vZGUsIGFuY2hvck9mZnNldCwgZm9jdXNOb2RlLCBmb2N1c09mZnNldCwgaXNDb2xsYXBzZWQgfSA9IG5hdGl2ZVNlbGVjdGlvblxuICBjb25zdCBhbmNob3IgPSBmaW5kUG9pbnQoYW5jaG9yTm9kZSwgYW5jaG9yT2Zmc2V0LCBzdGF0ZSlcbiAgY29uc3QgZm9jdXMgPSBpc0NvbGxhcHNlZCA/IGFuY2hvciA6IGZpbmRQb2ludChmb2N1c05vZGUsIGZvY3VzT2Zmc2V0LCBzdGF0ZSlcbiAgaWYgKCFhbmNob3IgfHwgIWZvY3VzKSByZXR1cm4gbnVsbFxuXG4gIGNvbnN0IHJhbmdlID0gUmFuZ2UuY3JlYXRlKHtcbiAgICBhbmNob3JLZXk6IGFuY2hvci5rZXksXG4gICAgYW5jaG9yT2Zmc2V0OiBhbmNob3Iub2Zmc2V0LFxuICAgIGZvY3VzS2V5OiBmb2N1cy5rZXksXG4gICAgZm9jdXNPZmZzZXQ6IGZvY3VzLm9mZnNldCxcbiAgICBpc0JhY2t3YXJkOiBpc0JhY2t3YXJkKG5hdGl2ZVNlbGVjdGlvbiksXG4gICAgaXNGb2N1c2VkOiB0cnVlLFxuICB9KVxuXG4gIHJldHVybiByYW5nZVxufVxuXG4vKipcbiAqIEV4cG9ydC5cbiAqXG4gKiBAdHlwZSB7RnVuY3Rpb259XG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZmluZFNlbGVjdGlvblxuIl19